{% load static %}
{% include "main_template/navbar.html" %}
{% block content %}

<div class="container mt-5">

  <!-- Post Card -->
  <div class="card shadow-lg mb-4">
    <div class="card-body">
      <h2 class="card-title">{{ post.title }}</h2>
      <p class="text-muted mb-2">Posted by <strong>{{ post.user }}</strong> on {{ post.created_at|date:"F j, Y, g:i a" }}</p>
      <p class="card-text">{{ post.content }}</p>
    </div>
  </div>

  <!-- Image Gallery -->
  <div class="mb-4">
    <h4>Images:</h4>
    {% if post.images.all %}
      <div class="row g-3">
        {% for image in post.images.all %}
          <div class="col-md-4 col-sm-6">
            <div class="card">
              <img src="{{ image.image.url }}" class="card-img-top img-fluid rounded" alt="Post Image">
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="card">
        <img src="{% static 'images/blog-large-2.jpg' %}" class="card-img-top img-fluid rounded" alt="Default Image">
        <div class="card-body text-muted">
          <p class="mb-0">No images uploaded for this post.</p>
        </div>
      </div>
    {% endif %}
  </div>

  <!-- Comments Section -->
<div id="comment-section" class="card shadow-sm mb-4" hx-swap-oob="true">
  <div class="card-body">
    <h4 class="card-title">Comments:</h4>
    {% for comment in comments %}
      <div class="d-flex mb-3 border-bottom pb-2">
        <img src="{% static 'images/default-avatar.png' %}" class="rounded-circle me-3" width="40" height="40" alt="User Avatar">
        <div>
          <strong>{{ comment.user }}</strong><br>
          <p class="mb-0">{{ comment.text }}</p>
          <small class="text-muted">{{ comment.created_at|date:"F j, Y, g:i a" }}</small>
        </div>
      </div>
    {% empty %}
      <p class="text-muted">No comments yet.</p>
    {% endfor %}
  </div>
</div>


  <!-- Comment Form -->
<div class="card shadow-sm">
  <div class="card-body">
    <h4 class="card-title mb-3">Leave a comment:</h4>
    <form 
      method="post"
      hx-post="{% url 'post_detail' post.pk %}"
      hx-target="#comment-section"
      hx-swap="outerHTML"
    >
      {% csrf_token %}
      {{ comment_form.as_p }}
      <button type="submit" class="btn btn-success">Post Comment</button>
    </form>
  </div>
</div>


</div>

{% endblock content %}
